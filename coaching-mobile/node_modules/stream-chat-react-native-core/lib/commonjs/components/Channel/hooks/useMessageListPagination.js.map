{"version":3,"names":["_react","require","_debounce","_interopRequireDefault","_useChannelDataState","_hooks","_utils","defaultDebounceInterval","debounceOptions","leading","trailing","useMessageListPagination","exports","_ref","channel","_useChannelMessageDat","useChannelMessageDataState","copyMessagesStateFromChannel","jumpToLatestMessage","jumpToMessageFinished","loadInitialMessagesStateFromChannel","loadMoreFinishedFn","loadMoreFinished","loadMoreRecentFinishedFn","loadMoreRecentFinished","setLoading","setLoadingMore","setLoadingMoreRecent","state","useRef","debounce","hasMore","messages","current","newMessages","loadLatestMessages","useStableCallback","_asyncToGenerator2","default","loadMessageIntoState","messagePagination","hasPrev","err","console","warn","loadMore","_state$messages","limit","arguments","length","undefined","loadingMore","loadingMoreRecent","oldestMessage","oldestID","id","query","id_lt","watchers","e","loadMoreRecent","_state$messages2","hasNext","newestMessage","newestID","id_gt","loadChannelAroundMessage","_ref6","_ref5","_ref5$limit","messageIdToLoadAround","messageId","setTargetedMessage","error","_x","apply","fetchMessagesAround","_ref7","timestamp","_yield$channel$query","created_at_around","_x2","_x3","_x4","loadChannelAtFirstUnreadMessage","_ref9","_ref8","channelUnreadState","_ref8$limit","setChannelUnreadState","unread_messages","first_unread_message_id","last_read","last_read_message_id","firstUnreadMessageId","lastReadMessageId","isInCurrentMessageSet","messagesState","messageIdx","findInMessagesById","_messagesState","lastReadTimestamp","getTime","_findInMessagesByDate","findInMessagesByDate","lastReadIdx","index","lastReadMessage","message","toISOString","log","firstMessageWithCreationDate","find","msg","created_at","Error","firstMessageTimestamp","Date","_result$message","result","targetedMessage","indexOfTarget","findIndex","Object","assign","_x5"],"sourceRoot":"../../../../../src","sources":["components/Channel/hooks/useMessageListPagination.tsx"],"mappings":"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","ignoreList":[]}
